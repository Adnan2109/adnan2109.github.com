<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Racing Game</title>
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three/examples/js/loaders/GLTFLoader.js"></script>
    <script>
        // Scene Setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Lighting
        const light = new THREE.PointLight(0xffffff, 1, 100);
        light.position.set(0, 50, 50);
        scene.add(light);

        // Skybox (simple background)
        const textureLoader = new THREE.CubeTextureLoader();
        const skyboxTexture = textureLoader.load([
            'https://cdn.pixabay.com/photo/2017/08/30/01/47/sky-2695565_960_720.jpg', // Front
            'https://cdn.pixabay.com/photo/2017/08/30/01/47/sky-2695565_960_720.jpg', // Back
            'https://cdn.pixabay.com/photo/2017/08/30/01/47/sky-2695565_960_720.jpg', // Right
            'https://cdn.pixabay.com/photo/2017/08/30/01/47/sky-2695565_960_720.jpg', // Left
            'https://cdn.pixabay.com/photo/2017/08/30/01/47/sky-2695565_960_720.jpg', // Top
            'https://cdn.pixabay.com/photo/2017/08/30/01/47/sky-2695565_960_720.jpg'  // Bottom
        ]);
        scene.background = skyboxTexture;

        // Create a simple road (improve the track)
        const roadGeometry = new THREE.PlaneGeometry(100, 200);
        const roadMaterial = new THREE.MeshLambertMaterial({ color: 0x2c3e50 });
        const road = new THREE.Mesh(roadGeometry, roadMaterial);
        road.rotation.x = - Math.PI / 2;
        road.position.y = -1;
        scene.add(road);

        // Load Car Model (replace the cube with a GLTF model)
        const loader = new THREE.GLTFLoader();
        let car;

        loader.load('https://cdn.jsdelivr.net/gh/mrdoob/three.js/examples/models/gltf/Car.glb', function(gltf) {
            car = gltf.scene;
            car.scale.set(0.5, 0.5, 0.5); // Scale the car model to fit
            car.position.y = 1;
            scene.add(car);
        }, undefined, function(error) {
            console.error(error);
        });

        // Camera setup
        camera.position.z = 20;
        camera.position.y = 5;

        // Car movement variables
        let speed = 0;
        let acceleration = 0.1;
        let friction = 0.98;
        let maxSpeed = 5;
        let turnSpeed = 0.05;

        // Keyboard input
        document.addEventListener('keydown', (event) => {
            if (event.key === 'w') speed = Math.min(speed + acceleration, maxSpeed);
            if (event.key === 's') speed = Math.max(speed - acceleration, -maxSpeed);
            if (event.key === 'a') car.rotation.y += turnSpeed;
            if (event.key === 'd') car.rotation.y -= turnSpeed;
        });

        // Game loop
        function animate() {
            requestAnimationFrame(animate);

            if (car) {
                // Apply friction
                speed *= friction;

                // Move the car based on speed and direction
                car.position.x += Math.sin(car.rotation.y) * speed;
                car.position.z += Math.cos(car.rotation.y) * speed;

                // Update camera position
                camera.position.x = car.position.x + 10 * Math.sin(car.rotation.y);
                camera.position.z = car.position.z + 10 * Math.cos(car.rotation.y);
                camera.position.y = car.position.y + 5;
                camera.lookAt(car.position);
            }

            renderer.render(scene, camera);
        }

        animate();

    </script>
</body>
</html>
